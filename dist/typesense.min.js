"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var Fe=Object.create;var Ce=Object.defineProperty;var je=Object.getOwnPropertyDescriptor;var ze=Object.getOwnPropertyNames;var Le=Object.getPrototypeOf,Je=Object.prototype.hasOwnProperty;var Se=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Qe=(r,e)=>{for(var t in e)Ce(r,t,{get:e[t],enumerable:!0})},Be=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of ze(e))!Je.call(r,n)&&n!==t&&Ce(r,n,{get:()=>e[n],enumerable:!(i=je(e,n))||i.enumerable});return r};var ve=(r,e,t)=>(t=r!=null?Fe(Le(r)):{},Be(e||!r||!r.__esModule?Ce(t,"default",{value:r,enumerable:!0}):t,r));var Te=Se((Bt,be)=>{"use strict";be.exports={}});var we=Se((Vt,Ee)=>{"use strict";Ee.exports={}});var ke=Se((ti,Ie)=>{"use strict";Ie.exports={}});var _loglevel = require('loglevel'); var _loglevel2 = _interopRequireDefault(_loglevel);var _e={};Qe(_e,{HTTPError:()=>R,ImportError:()=>y,MissingConfigurationError:()=>g,ObjectAlreadyExists:()=>x,ObjectNotFound:()=>f,ObjectUnprocessable:()=>A,RequestMalformed:()=>_,RequestUnauthorized:()=>b,ServerError:()=>T,TypesenseError:()=>l});var l=class extends Error{constructor(e,t,i){super(e),this.name=new.target.name,this.httpBody=t,this.httpStatus=i,Object.setPrototypeOf(this,new.target.prototype)}};var R=class extends l{};var g=class extends l{};var x=class extends l{};var f=class extends l{};var A=class extends l{};var _=class extends l{};var b=class extends l{};var T=class extends l{};var y=class extends l{constructor(e,t,i){super(e),this.importResults=t,this.payload=i}};var E=class{constructor(e){this.nodes=e.nodes||[],this.nodes=this.nodes.map(t=>this.setDefaultPathInNode(t)).map(t=>this.setDefaultPortInNode(t)).map(t=>({...t})),e.randomizeNodes==null&&(e.randomizeNodes=!0),e.randomizeNodes===!0&&this.shuffleArray(this.nodes),this.nearestNode=e.nearestNode,this.nearestNode=this.setDefaultPathInNode(this.nearestNode),this.nearestNode=this.setDefaultPortInNode(this.nearestNode),this.connectionTimeoutSeconds=e.connectionTimeoutSeconds||e.timeoutSeconds||5,this.healthcheckIntervalSeconds=e.healthcheckIntervalSeconds||60,this.numRetries=(e.numRetries!==void 0&&e.numRetries>=0?e.numRetries:this.nodes.length+(this.nearestNode==null?0:1))||3,this.retryIntervalSeconds=e.retryIntervalSeconds||.1,this.apiKey=e.apiKey,this.sendApiKeyAsQueryParam=e.sendApiKeyAsQueryParam,this.cacheSearchResultsForSeconds=e.cacheSearchResultsForSeconds||0,this.useServerSideSearchCache=e.useServerSideSearchCache||!1,this.axiosAdapter=e.axiosAdapter,this.logger=e.logger||_loglevel2.default,this.logLevel=e.logLevel||"warn",this.logger.setLevel(this.logLevel),this.additionalHeaders=e.additionalHeaders,this.httpAgent=e.httpAgent,this.httpsAgent=e.httpsAgent,this.paramsSerializer=e.paramsSerializer,this.showDeprecationWarnings(e),this.validate()}validate(){if(this.nodes==null||this.nodes.length===0||this.validateNodes())throw new g("Ensure that nodes[].protocol, nodes[].host and nodes[].port are set");if(this.nearestNode!=null&&this.isNodeMissingAnyParameters(this.nearestNode))throw new g("Ensure that nearestNodes.protocol, nearestNodes.host and nearestNodes.port are set");if(this.apiKey==null)throw new g("Ensure that apiKey is set");return!0}validateNodes(){return this.nodes.some(e=>this.isNodeMissingAnyParameters(e))}isNodeMissingAnyParameters(e){return!["protocol","host","port","path"].every(t=>e.hasOwnProperty(t))&&e.url==null}setDefaultPathInNode(e){return e!=null&&!e.hasOwnProperty("path")&&(e.path=""),e}setDefaultPortInNode(e){if(e!=null&&!e.hasOwnProperty("port")&&e.hasOwnProperty("protocol"))switch(e.protocol){case"https":e.port=443;break;case"http":e.port=80;break}return e}showDeprecationWarnings(e){e.timeoutSeconds&&this.logger.warn("Deprecation warning: timeoutSeconds is now renamed to connectionTimeoutSeconds"),e.masterNode&&this.logger.warn("Deprecation warning: masterNode is now consolidated to nodes, starting with Typesense Server v0.12"),e.readReplicaNodes&&this.logger.warn("Deprecation warning: readReplicaNodes is now consolidated to nodes, starting with Typesense Server v0.12")}shuffleArray(e){for(let t=e.length-1;t>0;t--){let i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}}};var De=ve(Te()),Ne=ve(we());var _axios = require('axios'); var _axios2 = _interopRequireDefault(_axios);var Ye="X-TYPESENSE-API-KEY",Pe=!0,Ge=!1,Oe=typeof process<"u"&&process.versions!=null&&process.versions.node!=null,w=class{constructor(e){this.configuration=e;this.apiKey=this.configuration.apiKey,this.nodes=this.configuration.nodes==null?this.configuration.nodes:JSON.parse(JSON.stringify(this.configuration.nodes)),this.nearestNode=this.configuration.nearestNode==null?this.configuration.nearestNode:JSON.parse(JSON.stringify(this.configuration.nearestNode)),this.connectionTimeoutSeconds=this.configuration.connectionTimeoutSeconds,this.healthcheckIntervalSeconds=this.configuration.healthcheckIntervalSeconds,this.numRetriesPerRequest=this.configuration.numRetries,this.retryIntervalSeconds=this.configuration.retryIntervalSeconds,this.sendApiKeyAsQueryParam=this.configuration.sendApiKeyAsQueryParam,this.additionalUserHeaders=this.configuration.additionalHeaders,this.logger=this.configuration.logger,this.initializeMetadataForNodes(),this.currentNodeIndex=-1}async get(e,t={},{abortSignal:i=null,responseType:n=void 0}={}){return this.performRequest("get",e,{queryParameters:t,abortSignal:i,responseType:n})}async delete(e,t={}){return this.performRequest("delete",e,{queryParameters:t})}async post(e,t={},i={},n={}){return this.performRequest("post",e,{queryParameters:i,bodyParameters:t,additionalHeaders:n})}async put(e,t={},i={}){return this.performRequest("put",e,{queryParameters:i,bodyParameters:t})}async patch(e,t={},i={}){return this.performRequest("patch",e,{queryParameters:i,bodyParameters:t})}getAdapter(){return this.configuration.axiosAdapter?typeof this.configuration.axiosAdapter=="function"?this.configuration.axiosAdapter:typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"?_axios2.default.getAdapter(this.configuration.axiosAdapter).bind(globalThis):_axios2.default.getAdapter(this.configuration.axiosAdapter):void 0}async performRequest(e,t,{queryParameters:i=null,bodyParameters:n=null,additionalHeaders:s={},abortSignal:a=null,responseType:h=void 0,skipConnectionTimeout:m=!1,enableKeepAlive:C=void 0}){this.configuration.validate();let c=Date.now(),S,j=!1;this.logger.debug(`Request #${c}: Performing ${e.toUpperCase()} request: ${t}`);for(let v=1;v<=this.numRetriesPerRequest+1;v++){let P=this.getNextNode(c);if(this.logger.debug(`Request #${c}: Attempting ${e.toUpperCase()} request Try #${v} to Node ${P.index}`),a&&a.aborted)return Promise.reject(new Error("Request aborted by caller."));let Q;try{let o={adapter:this.getAdapter(),method:e,url:this.uriFor(t,P),headers:Object.assign({},this.defaultHeaders(),s,this.additionalUserHeaders),maxContentLength:1/0,maxBodyLength:1/0,responseType:h,validateStatus:z=>z>0,transformResponse:[(z,L)=>{let Ae=z;return L!==void 0&&typeof z=="string"&&L["content-type"]&&L["content-type"].startsWith("application/json")&&(Ae=JSON.parse(z)),Ae}]};if(m!==!0&&(o.timeout=this.connectionTimeoutSeconds*1e3),i&&Object.keys(i).length!==0&&(o.params=i),this.sendApiKeyAsQueryParam&&(o.params=o.params||{},o.params["x-typesense-api-key"]=this.apiKey),this.configuration.httpAgent?(this.logger.debug(`Request #${c}: Using custom httpAgent`),o.httpAgent=this.configuration.httpAgent):C===!0&&(Oe?(this.logger.debug(`Request #${c}: Enabling KeepAlive`),o.httpAgent=new De.Agent({keepAlive:!0})):this.logger.warn(`Request #${c}: Cannot use custom httpAgent in a browser environment to enable keepAlive`)),this.configuration.httpsAgent?(this.logger.debug(`Request #${c}: Using custom httpsAgent`),o.httpsAgent=this.configuration.httpsAgent):C===!0&&(Oe?(this.logger.debug(`Request #${c}: Enabling keepAlive`),o.httpsAgent=new Ne.Agent({keepAlive:!0})):this.logger.warn(`Request #${c}: Cannot use custom httpAgent in a browser environment to enable keepAlive`)),this.configuration.paramsSerializer&&(this.logger.debug(`Request #${c}: Using custom paramsSerializer`),o.paramsSerializer=this.configuration.paramsSerializer),n&&(typeof n=="string"&&n.length!==0||typeof n=="object"&&Object.keys(n).length!==0)&&(o.data=n),a){let L=_axios2.default.CancelToken.source();Q=()=>{j=!0,L.cancel()},a.addEventListener("abort",Q),o.cancelToken=L.token}let d=await _axios2.default.call(void 0, o);if(d.status>=1&&d.status<=499&&this.setNodeHealthcheck(P,Pe),this.logger.debug(`Request #${c}: Request to Node ${P.index} was made. Response Code was ${d.status}.`),d.status>=200&&d.status<300)return Promise.resolve(d.data);if(d.status<500)return Promise.reject(this.customErrorForResponse(d,_optionalChain([d, 'access', _2 => _2.data, 'optionalAccess', _3 => _3.message]),o.data));throw this.customErrorForResponse(d,_optionalChain([d, 'access', _4 => _4.data, 'optionalAccess', _5 => _5.message]),o.data)}catch(o){if(j||this.setNodeHealthcheck(P,Ge),S=o,this.logger.warn(`Request #${c}: Request to Node ${P.index} failed due to "${_nullishCoalesce(_optionalChain([o, 'optionalAccess', _6 => _6.code]), () => (""))} ${o.message}${o.response==null?"":" - "+JSON.stringify(_optionalChain([o, 'access', _7 => _7.response, 'optionalAccess', _8 => _8.data]))}"`),j)return Promise.reject(new Error("Request aborted by caller."));v<this.numRetriesPerRequest+1&&this.logger.warn(`Request #${c}: Sleeping for ${this.retryIntervalSeconds}s and then retrying request...`),await this.timer(this.retryIntervalSeconds)}finally{a&&Q&&a.removeEventListener("abort",Q)}}return this.logger.debug(`Request #${c}: No retries left. Raising last error`),Promise.reject(S)}getNextNode(e=0){if(this.nearestNode!=null){if(this.logger.debug(`Request #${e}: Nodes Health: Node ${this.nearestNode.index} is ${this.nearestNode.isHealthy===!0?"Healthy":"Unhealthy"}`),this.nearestNode.isHealthy===!0||this.nodeDueForHealthcheck(this.nearestNode,e))return this.logger.debug(`Request #${e}: Updated current node to Node ${this.nearestNode.index}`),this.nearestNode;this.logger.debug(`Request #${e}: Falling back to individual nodes`)}this.logger.debug(`Request #${e}: Nodes Health: ${this.nodes.map(i=>`Node ${i.index} is ${i.isHealthy===!0?"Healthy":"Unhealthy"}`).join(" || ")}`);let t=this.nodes[0];for(let i=0;i<=this.nodes.length;i++)if(this.currentNodeIndex=(this.currentNodeIndex+1)%this.nodes.length,t=this.nodes[this.currentNodeIndex],t.isHealthy===!0||this.nodeDueForHealthcheck(t,e))return this.logger.debug(`Request #${e}: Updated current node to Node ${t.index}`),t;return this.logger.debug(`Request #${e}: No healthy nodes were found. Returning the next node, Node ${t.index}`),t}nodeDueForHealthcheck(e,t=0){let i=Date.now()-e.lastAccessTimestamp>this.healthcheckIntervalSeconds*1e3;return i&&this.logger.debug(`Request #${t}: Node ${e.index} has exceeded healtcheckIntervalSeconds of ${this.healthcheckIntervalSeconds}. Adding it back into rotation.`),i}initializeMetadataForNodes(){this.nearestNode!=null&&(this.nearestNode.index="nearestNode",this.setNodeHealthcheck(this.nearestNode,Pe)),this.nodes.forEach((e,t)=>{e.index=t,this.setNodeHealthcheck(e,Pe)})}setNodeHealthcheck(e,t){e.isHealthy=t,e.lastAccessTimestamp=Date.now()}uriFor(e,t){return t.url!=null?`${t.url}${e}`:`${t.protocol}://${t.host}:${t.port}${t.path}${e}`}defaultHeaders(){let e={};return this.sendApiKeyAsQueryParam||(e[Ye]=this.apiKey),e["Content-Type"]="application/json",e}async timer(e){return new Promise(t=>setTimeout(t,e*1e3))}customErrorForResponse(e,t,i){let n=`Request failed with HTTP code ${e.status}`;typeof t=="string"&&t.trim()!==""&&(n+=` | Server said: ${t}`);let s=new l(n,i,e.status);return e.status===400?s=new _(n):e.status===401?s=new b(n):e.status===404?s=new f(n):e.status===409?s=new x(n):e.status===422?s=new A(n):e.status>=500&&e.status<=599?s=new T(n):s=new R(n),s}};var O=class{constructor(){this.responseCache=new Map;this.responsePromiseCache=new Map}clearCache(){this.responseCache=new Map,this.responsePromiseCache=new Map}async perform(e,t,i,n){let{cacheResponseForSeconds:s=120,maxSize:a=100}=n;if(s<=0||a<=0)return t.call(e,...i);let m=JSON.stringify(i),C=this.responseCache.get(m),c=Date.now();if(C){if(c-C.requestTimestamp<s*1e3)return this.responseCache.delete(m),this.responseCache.set(m,C),Promise.resolve(C.response);this.responseCache.delete(m)}let S=this.responsePromiseCache.get(m);if(S){if(c-S.requestTimestamp<s*1e3)return this.responsePromiseCache.delete(m),this.responsePromiseCache.set(m,S),S.responsePromise;this.responsePromiseCache.delete(m)}let j=t.call(e,...i);this.responsePromiseCache.set(m,{requestTimestamp:c,responsePromise:j});let v=await j;if(this.responseCache.set(m,{requestTimestamp:c,response:v}),this.responseCache.size>a){let o=this.responseCache.keys().next().value;o&&this.responseCache.delete(o)}if(this.responsePromiseCache.size>a){let o=this.responsePromiseCache.keys().next().value;o&&this.responsePromiseCache.delete(o)}return v}};var Re="/collections",p=class{constructor(e){this.apiCall=e}async create(e,t={}){return this.apiCall.post(Re,e,t)}async retrieve(e={}){return this.apiCall.get(Re,e)}static get RESOURCEPATH(){return Re}};var Ue="/documents",J=class{constructor(e,t,i){this.collectionName=e;this.apiCall=t;this.configuration=i;this.requestWithCache=new O}clearCache(){this.requestWithCache.clearCache()}async search(e,{cacheSearchResultsForSeconds:t=this.configuration.cacheSearchResultsForSeconds,abortSignal:i=null}={}){let n={};this.configuration.useServerSideSearchCache===!0&&(n.use_cache=!0);let s=u(e),a=Object.assign({},n,s);return this.requestWithCache.perform(this.apiCall,this.apiCall.get,[this.endpointPath("search"),a,{abortSignal:i}],{cacheResponseForSeconds:t})}endpointPath(e){return`${p.RESOURCEPATH}/${this.collectionName}${Ue}${e===void 0?"":"/"+e}`}static get RESOURCEPATH(){return Ue}};var xe={query_by:"query_by",query_by_weights:"query_by_weights",facet_by:"facet_by",group_by:"group_by",include_fields:"include_fields",exclude_fields:"exclude_fields",highlight_fields:"highlight_fields",highlight_full_fields:"highlight_full_fields",pinned_hits:"pinned_hits",hidden_hits:"hidden_hits",infix:"infix",override_tags:"override_tags",num_typos:"num_typos",prefix:"prefix",sort_by:"sort_by"},He=typeof process<"u"&&process.versions!=null&&process.versions.node!=null,D=class extends J{constructor(e,t,i){super(e,t,i)}async create(e,t={}){if(!e)throw new Error("No document provided");return this.apiCall.post(this.endpointPath(),e,t)}async upsert(e,t={}){if(!e)throw new Error("No document provided");return this.apiCall.post(this.endpointPath(),e,Object.assign({},t,{action:"upsert"}))}async update(e,t={}){if(!e)throw new Error("No document provided");return t.filter_by!=null?this.apiCall.patch(this.endpointPath(),e,Object.assign({},t)):this.apiCall.post(this.endpointPath(),e,Object.assign({},t,{action:"update"}))}async delete(e={}){return this.apiCall.delete(this.endpointPath(),e)}async createMany(e,t={}){return this.configuration.logger.warn("createMany is deprecated and will be removed in a future version. Use import instead, which now takes both an array of documents or a JSONL string of documents"),this.import(e,t)}async import(e,t={}){let i;if(Array.isArray(e))try{i=e.map(s=>JSON.stringify(s)).join(`
`)}catch(s){throw s instanceof RangeError&&s.message.includes("Too many properties to enumerate")?new Error(`${s}
          It looks like you have reached a Node.js limit that restricts the number of keys in an Object: https://stackoverflow.com/questions/9282869/are-there-limits-to-the-number-of-properties-in-a-javascript-object

         Please try reducing the number of keys in your document, or using CURL to import your data.
          `):new Error(s)}else i=e;let n=await this.apiCall.performRequest("post",this.endpointPath("import"),{queryParameters:t,bodyParameters:i,additionalHeaders:{"Content-Type":"text/plain"},skipConnectionTimeout:!0,enableKeepAlive:!!He});if(Array.isArray(e)){let s=n.split(`
`).map(h=>JSON.parse(h)),a=s.filter(h=>h.success===!1);if(a.length>0)throw new y(`${s.length-a.length} documents imported successfully, ${a.length} documents failed during import. Use \`error.importResults\` from the raised exception to get a detailed error reason for each document.`,s,{documentsInJSONLFormat:i,options:t,failedItems:a,successCount:s.length-a.length});return s}else return n}async importStream(e,t={}){let n=(await this.apiCall.performRequest("post",this.endpointPath("import"),{queryParameters:t,bodyParameters:e,additionalHeaders:{"Content-Type":"text/plain"},skipConnectionTimeout:!0,enableKeepAlive:!!He})).split(`
`).map(a=>JSON.parse(a)),s=n.filter(a=>a.success===!1);if(s.length>0)throw new y(`${n.length-s.length} documents imported successfully, ${s.length} documents failed during import. Use \`error.importResults\` from the raised exception to get a detailed error reason for each document.`,n,{documentsInJSONLFormat:e,options:t,failedItems:s,successCount:n.length-s.length});return n}async export(e={}){return this.apiCall.get(this.endpointPath("export"),e)}async exportStream(e={}){return this.apiCall.get(this.endpointPath("export"),e,{responseType:"stream"})}};function $e(r){return Object.keys(xe).filter(e=>r[e]!==void 0).every(e=>Xe(r[e]))}function u(r){let e={...r};if(!Object.keys(xe).filter(i=>Array.isArray(e[i])).map(i=>(e[i]=e[i].join(","),i)).length&&$e(e))return e;if(!$e(e))throw new Error(`Failed to normalize arrayable params: ${JSON.stringify(e)}`);return e}function Xe(r){return!Array.isArray(r)}var Ze="/multi_search",N=class{constructor(e,t,i=!1){this.apiCall=e;this.configuration=t;this.useTextContentType=i;this.requestWithCache=new O}clearCache(){this.requestWithCache.clearCache()}async perform(e,t={},{cacheSearchResultsForSeconds:i=this.configuration.cacheSearchResultsForSeconds}={}){let n={};this.useTextContentType&&(n["content-type"]="text/plain");let s={};this.configuration.useServerSideSearchCache===!0&&(s.use_cache=!0);let a={...t,...s},h={searches:e.searches.map(u)},m=u(a);return this.requestWithCache.perform(this.apiCall,this.apiCall.post,[Ze,h,m,n],{cacheResponseForSeconds:i})}};var ue=class{constructor(e,t,i){this.name=e;this.apiCall=t;this.configuration=i;this._documents=new J(this.name,this.apiCall,this.configuration)}documents(){return this._documents}};var ge=class{constructor(e){e.sendApiKeyAsQueryParam=_nullishCoalesce(e.sendApiKeyAsQueryParam, () => (!0)),e.sendApiKeyAsQueryParam===!0&&(e.apiKey||"").length>2e3&&(console.warn("[typesense] API Key is longer than 2000 characters which is over the allowed limit, so disabling sending it as a query parameter."),e.sendApiKeyAsQueryParam=!1),this.configuration=new E(e),this.apiCall=new w(this.configuration),this.multiSearch=new N(this.apiCall,this.configuration,!0),this.individualCollections={}}clearCache(){this.multiSearch.clearCache(),Object.entries(this.individualCollections).forEach(([e,t])=>{t.documents().clearCache()})}collections(e){if(e)return this.individualCollections[e]===void 0&&(this.individualCollections[e]=new ue(e,this.apiCall,this.configuration)),this.individualCollections[e];throw new Error("Typesense.SearchClient only supports search operations, so the collectionName that needs to be searched must be specified. Use Typesense.Client if you need to access the collection object.")}};var et="/overrides",U=class r{constructor(e,t){this.collectionName=e;this.apiCall=t}async upsert(e,t){return this.apiCall.put(this.endpointPath(e),t)}async retrieve(){return this.apiCall.get(this.endpointPath())}endpointPath(e){return`${p.RESOURCEPATH}/${this.collectionName}${r.RESOURCEPATH}${e===void 0?"":"/"+encodeURIComponent(e)}`}static get RESOURCEPATH(){return et}};var B=class{constructor(e,t,i){this.collectionName=e;this.overrideId=t;this.apiCall=i}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${p.RESOURCEPATH}/${encodeURIComponent(this.collectionName)}${U.RESOURCEPATH}/${encodeURIComponent(this.overrideId)}`}};var tt="/synonyms",H=class r{constructor(e,t){this.collectionName=e;this.apiCall=t}async upsert(e,t){return this.apiCall.put(this.endpointPath(e),t)}async retrieve(){return this.apiCall.get(this.endpointPath())}endpointPath(e){return`${p.RESOURCEPATH}/${encodeURIComponent(this.collectionName)}${r.RESOURCEPATH}${e===void 0?"":"/"+encodeURIComponent(e)}`}static get RESOURCEPATH(){return tt}};var V=class{constructor(e,t,i){this.collectionName=e;this.synonymId=t;this.apiCall=i}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${p.RESOURCEPATH}/${encodeURIComponent(this.collectionName)}${H.RESOURCEPATH}/${encodeURIComponent(this.synonymId)}`}};var fe=class{constructor(e,t,i){this.collectionName=e;this.documentId=t;this.apiCall=i}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(e){return this.apiCall.delete(this.endpointPath(),e)}async update(e,t={}){return this.apiCall.patch(this.endpointPath(),e,t)}endpointPath(){return`${p.RESOURCEPATH}/${encodeURIComponent(this.collectionName)}${D.RESOURCEPATH}/${encodeURIComponent(this.documentId)}`}};var Y=class{constructor(e,t,i){this.name=e;this.apiCall=t;this.configuration=i;this.individualDocuments={};this.individualOverrides={};this.individualSynonyms={};this.name=e,this.apiCall=t,this.configuration=i,this._documents=new D(this.name,this.apiCall,this.configuration),this._overrides=new U(this.name,this.apiCall),this._synonyms=new H(this.name,this.apiCall)}async retrieve(){return this.apiCall.get(this.endpointPath())}async update(e){return this.apiCall.patch(this.endpointPath(),e)}async delete(e={}){return this.apiCall.delete(this.endpointPath(),e)}async exists(){try{return await this.retrieve(),!0}catch(e){if(e instanceof f)return!1;throw e}}documents(e){return e?(this.individualDocuments[e]===void 0&&(this.individualDocuments[e]=new fe(this.name,e,this.apiCall)),this.individualDocuments[e]):this._documents}overrides(e){return e===void 0?this._overrides:(this.individualOverrides[e]===void 0&&(this.individualOverrides[e]=new B(this.name,e,this.apiCall)),this.individualOverrides[e])}synonyms(e){return e===void 0?this._synonyms:(this.individualSynonyms[e]===void 0&&(this.individualSynonyms[e]=new V(this.name,e,this.apiCall)),this.individualSynonyms[e])}endpointPath(){return`${p.RESOURCEPATH}/${encodeURIComponent(this.name)}`}};var qe="/aliases",$=class r{constructor(e){this.apiCall=e}async upsert(e,t){return this.apiCall.put(this.endpointPath(e),t)}async retrieve(){return this.apiCall.get(qe)}endpointPath(e){return`${r.RESOURCEPATH}/${encodeURIComponent(e)}`}static get RESOURCEPATH(){return qe}};var G=class{constructor(e,t){this.name=e;this.apiCall=t}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${$.RESOURCEPATH}/${encodeURIComponent(this.name)}`}};var Me=ve(ke());var Ke="/keys",q=class r{constructor(e){this.apiCall=e;this.apiCall=e}async create(e){return this.apiCall.post(r.RESOURCEPATH,e)}async retrieve(){return this.apiCall.get(Ke)}generateScopedSearchKey(e,t){let i=u(t),n=JSON.stringify(i),s=Buffer.from((0,Me.createHmac)("sha256",e).update(n).digest("base64")),a=e.substr(0,4),h=`${s}${a}${n}`;return Buffer.from(h).toString("base64")}static get RESOURCEPATH(){return Ke}};var X=class{constructor(e,t){this.id=e;this.apiCall=t}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${q.RESOURCEPATH}/${encodeURIComponent(this.id)}`}};var rt="/debug",Z=class{constructor(e){this.apiCall=e}async retrieve(){return this.apiCall.get(rt)}};var it="/metrics.json",ee=class{constructor(e){this.apiCall=e}async retrieve(){return this.apiCall.get(it)}};var nt="/stats.json",te=class{constructor(e){this.apiCall=e}async retrieve(){return this.apiCall.get(nt)}};var st="/health",re=class{constructor(e){this.apiCall=e}async retrieve(){return this.apiCall.get(st)}};var ot="/operations",ie=class{constructor(e){this.apiCall=e}async perform(e,t={}){return this.apiCall.post(`${ot}/${e}`,{},t)}};var at="/presets",I=class r{constructor(e){this.apiCall=e}async upsert(e,t){if(typeof t.value=="object"&&"searches"in t.value){let n=t.value.searches.map(s=>u(s));return this.apiCall.put(this.endpointPath(e),{value:{searches:n}})}let i=u(t.value);return this.apiCall.put(this.endpointPath(e),{value:i})}async retrieve(){return this.apiCall.get(this.endpointPath())}endpointPath(e){return`${r.RESOURCEPATH}${e===void 0?"":"/"+encodeURIComponent(e)}`}static get RESOURCEPATH(){return at}};var ne=class{constructor(e,t){this.presetId=e;this.apiCall=t}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${I.RESOURCEPATH}/${encodeURIComponent(this.presetId)}`}};var lt="/analytics/rules",k=class r{constructor(e){this.apiCall=e;this.apiCall=e}async upsert(e,t){return this.apiCall.put(this.endpointPath(e),t)}async retrieve(){return this.apiCall.get(this.endpointPath())}endpointPath(e){return`${r.RESOURCEPATH}${e===void 0?"":"/"+encodeURIComponent(e)}`}static get RESOURCEPATH(){return lt}};var se=class{constructor(e,t){this.name=e;this.apiCall=t}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${k.RESOURCEPATH}/${encodeURIComponent(this.name)}`}};var ct="/analytics/events",oe=class r{constructor(e){this.apiCall=e;this.apiCall=e}async create(e){return this.apiCall.post(this.endpointPath(),e)}endpointPath(e){return`${r.RESOURCEPATH}${e===void 0?"":"/"+encodeURIComponent(e)}`}static get RESOURCEPATH(){return ct}};var pt="/analytics",ae=class{constructor(e){this.apiCall=e;this.individualAnalyticsRules={};this.apiCall=e,this._analyticsRules=new k(this.apiCall),this._analyticsEvents=new oe(this.apiCall)}rules(e){return e===void 0?this._analyticsRules:(this.individualAnalyticsRules[e]===void 0&&(this.individualAnalyticsRules[e]=new se(e,this.apiCall)),this.individualAnalyticsRules[e])}events(){return this._analyticsEvents}static get RESOURCEPATH(){return pt}};var mt="/stopwords",K=class r{constructor(e){this.apiCall=e}async upsert(e,t){return this.apiCall.put(this.endpointPath(e),t)}async retrieve(){return this.apiCall.get(this.endpointPath())}endpointPath(e){return`${r.RESOURCEPATH}${e===void 0?"":"/"+encodeURIComponent(e)}`}static get RESOURCEPATH(){return mt}};var le=class{constructor(e,t){this.stopwordId=e;this.apiCall=t}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${K.RESOURCEPATH}/${encodeURIComponent(this.stopwordId)}`}};var dt="/conversations/models",M=class r{constructor(e){this.apiCall=e;this.apiCall=e}async create(e){return this.apiCall.post(this.endpointPath(),e)}async retrieve(){return this.apiCall.get(this.endpointPath())}endpointPath(e){return`${r.RESOURCEPATH}${e===void 0?"":"/"+encodeURIComponent(e)}`}static get RESOURCEPATH(){return dt}};var ce=class{constructor(e,t){this.id=e;this.apiCall=t}async update(e){return this.apiCall.put(this.endpointPath(),e)}async retrieve(){return this.apiCall.get(this.endpointPath())}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${M.RESOURCEPATH}/${encodeURIComponent(this.id)}`}};var We="/conversations",W=class{constructor(e){this.apiCall=e;this.individualConversationModels={};this.apiCall=e,this._conversationsModels=new M(this.apiCall)}async retrieve(){return this.apiCall.get(We)}models(e){return e===void 0?this._conversationsModels:(this.individualConversationModels[e]===void 0&&(this.individualConversationModels[e]=new ce(e,this.apiCall)),this.individualConversationModels[e])}static get RESOURCEPATH(){return We}};var pe=class{constructor(e,t){this.id=e;this.apiCall=t}async retrieve(){return this.apiCall.get(this.endpointPath())}async update(e){return this.apiCall.put(this.endpointPath(),e)}async delete(){return this.apiCall.delete(this.endpointPath())}endpointPath(){return`${W.RESOURCEPATH}/${encodeURIComponent(this.id)}`}};var ht="/stemming/dictionaries",F=class r{constructor(e){this.apiCall=e;this.apiCall=e}async upsert(e,t){let i=Array.isArray(t)?t.map(s=>JSON.stringify(s)).join(`
`):t,n=await this.apiCall.performRequest("post",this.endpointPath("import"),{queryParameters:{id:e},bodyParameters:i,additionalHeaders:{"Content-Type":"text/plain"},skipConnectionTimeout:!0});return Array.isArray(t)?n.split(`
`).map(s=>JSON.parse(s)):n}async retrieve(){return this.apiCall.get(this.endpointPath())}endpointPath(e){return e===void 0?`${r.RESOURCEPATH}`:`${r.RESOURCEPATH}/${encodeURIComponent(e)}`}static get RESOURCEPATH(){return ht}};var me=class{constructor(e,t){this.id=e;this.apiCall=t}async retrieve(){return this.apiCall.get(this.endpointPath())}endpointPath(){return`${F.RESOURCEPATH}/${encodeURIComponent(this.id)}`}};var ut="/stemming",de=class{constructor(e){this.apiCall=e;this.individualStemmingDictionaries={};this.apiCall=e,this._stemmingDictionaries=new F(this.apiCall)}dictionaries(e){return e===void 0?this._stemmingDictionaries:(this.individualStemmingDictionaries[e]===void 0&&(this.individualStemmingDictionaries[e]=new me(e,this.apiCall)),this.individualStemmingDictionaries[e])}static get RESOURCEPATH(){return ut}};var ye=class{constructor(e){e.sendApiKeyAsQueryParam=_nullishCoalesce(e.sendApiKeyAsQueryParam, () => (!1)),this.configuration=new E(e),this.apiCall=new w(this.configuration),this.debug=new Z(this.apiCall),this.metrics=new ee(this.apiCall),this.stats=new te(this.apiCall),this.health=new re(this.apiCall),this.operations=new ie(this.apiCall),this.multiSearch=new N(this.apiCall,this.configuration),this._collections=new p(this.apiCall),this.individualCollections={},this._aliases=new $(this.apiCall),this.individualAliases={},this._keys=new q(this.apiCall),this.individualKeys={},this._presets=new I(this.apiCall),this.individualPresets={},this._stopwords=new K(this.apiCall),this.individualStopwords={},this.analytics=new ae(this.apiCall),this.stemming=new de(this.apiCall),this._conversations=new W(this.apiCall),this.individualConversations={}}collections(e){return e===void 0?this._collections:(this.individualCollections[e]===void 0&&(this.individualCollections[e]=new Y(e,this.apiCall,this.configuration)),this.individualCollections[e])}aliases(e){return e===void 0?this._aliases:(this.individualAliases[e]===void 0&&(this.individualAliases[e]=new G(e,this.apiCall)),this.individualAliases[e])}keys(e){return e===void 0?this._keys:(this.individualKeys[e]===void 0&&(this.individualKeys[e]=new X(e,this.apiCall)),this.individualKeys[e])}presets(e){return e===void 0?this._presets:(this.individualPresets[e]===void 0&&(this.individualPresets[e]=new ne(e,this.apiCall)),this.individualPresets[e])}stopwords(e){return e===void 0?this._stopwords:(this.individualStopwords[e]===void 0&&(this.individualStopwords[e]=new le(e,this.apiCall)),this.individualStopwords[e])}conversations(e){return e===void 0?this._conversations:(this.individualConversations[e]===void 0&&(this.individualConversations[e]=new pe(e,this.apiCall)),this.individualConversations[e])}};exports.Client = ye; exports.Errors = _e; exports.SearchClient = ge;
//# sourceMappingURL=typesense.min.js.map